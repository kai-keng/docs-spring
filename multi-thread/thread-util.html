<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>jdk工具 | Java</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just record my learning process">
    <link rel="preload" href="/java-learning/assets/css/0.styles.dcc29016.css" as="style"><link rel="preload" href="/java-learning/assets/js/app.046a40f3.js" as="script"><link rel="preload" href="/java-learning/assets/js/2.cb888cbe.js" as="script"><link rel="preload" href="/java-learning/assets/js/28.9fa67906.js" as="script"><link rel="prefetch" href="/java-learning/assets/js/10.8638b991.js"><link rel="prefetch" href="/java-learning/assets/js/11.fa996cd1.js"><link rel="prefetch" href="/java-learning/assets/js/12.8ec6a2cc.js"><link rel="prefetch" href="/java-learning/assets/js/13.f596427d.js"><link rel="prefetch" href="/java-learning/assets/js/14.2549403a.js"><link rel="prefetch" href="/java-learning/assets/js/15.fe4a58bb.js"><link rel="prefetch" href="/java-learning/assets/js/16.7b8d367b.js"><link rel="prefetch" href="/java-learning/assets/js/17.d9dd8bfb.js"><link rel="prefetch" href="/java-learning/assets/js/18.502d2bd9.js"><link rel="prefetch" href="/java-learning/assets/js/19.cf055be3.js"><link rel="prefetch" href="/java-learning/assets/js/20.29650ce2.js"><link rel="prefetch" href="/java-learning/assets/js/21.37c7e0b2.js"><link rel="prefetch" href="/java-learning/assets/js/22.76f2ae5d.js"><link rel="prefetch" href="/java-learning/assets/js/23.4bc3d938.js"><link rel="prefetch" href="/java-learning/assets/js/24.24831809.js"><link rel="prefetch" href="/java-learning/assets/js/25.1a83af0d.js"><link rel="prefetch" href="/java-learning/assets/js/26.763cbe2a.js"><link rel="prefetch" href="/java-learning/assets/js/27.eef84ec1.js"><link rel="prefetch" href="/java-learning/assets/js/29.a8bd1b7c.js"><link rel="prefetch" href="/java-learning/assets/js/3.512a63a5.js"><link rel="prefetch" href="/java-learning/assets/js/30.fe1c1905.js"><link rel="prefetch" href="/java-learning/assets/js/31.c8c579ca.js"><link rel="prefetch" href="/java-learning/assets/js/32.76de8390.js"><link rel="prefetch" href="/java-learning/assets/js/33.b78dbf16.js"><link rel="prefetch" href="/java-learning/assets/js/34.d3cbc566.js"><link rel="prefetch" href="/java-learning/assets/js/35.9b64d0d8.js"><link rel="prefetch" href="/java-learning/assets/js/36.1f36f338.js"><link rel="prefetch" href="/java-learning/assets/js/37.6438e6a0.js"><link rel="prefetch" href="/java-learning/assets/js/38.e3396ab5.js"><link rel="prefetch" href="/java-learning/assets/js/39.8b644b85.js"><link rel="prefetch" href="/java-learning/assets/js/4.2ffd55ad.js"><link rel="prefetch" href="/java-learning/assets/js/40.1a0194ac.js"><link rel="prefetch" href="/java-learning/assets/js/5.4c0a6f56.js"><link rel="prefetch" href="/java-learning/assets/js/6.fe5c20c0.js"><link rel="prefetch" href="/java-learning/assets/js/7.68710204.js"><link rel="prefetch" href="/java-learning/assets/js/8.8a2a3006.js"><link rel="prefetch" href="/java-learning/assets/js/9.d83ea849.js">
    <link rel="stylesheet" href="/java-learning/assets/css/0.styles.dcc29016.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-learning/" class="home-link router-link-active"><!----> <span class="site-name">Java</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/spring-boot/" class="sidebar-heading clickable"><span>Spring Boot</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/spring-cloud/" class="sidebar-link">Spring Cloud</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/mysql/" class="sidebar-heading clickable"><span>MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/collection/" class="sidebar-link">集合框架</a></li><li><a href="/java-learning/jvm/" class="sidebar-link">JVM</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/multi-thread/" class="sidebar-heading clickable router-link-active open"><span>多线程</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-learning/multi-thread/basis.html" class="sidebar-link">多线程基础</a></li><li><a href="/java-learning/multi-thread/principle.html" class="sidebar-link">多线程原理</a></li><li><a href="/java-learning/multi-thread/thread-util.html" aria-current="page" class="active sidebar-link">jdk工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/multi-thread/thread-util.html#线程池" class="sidebar-link">线程池</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/design-pattern/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/internet/" class="sidebar-link">网络</a></li><li><a href="/java-learning/materials/" class="sidebar-link">相关资料</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jdk工具"><a href="#jdk工具" class="header-anchor">#</a> jdk工具</h1> <h2 id="线程池"><a href="#线程池" class="header-anchor">#</a> 线程池</h2> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <p>在多线程开发中，我们如果需要新建一个线程来完成我们的任务的话需要3个步骤：</p> <ol><li>新建线程</li> <li>线程完成任务</li> <li>销毁线程</li></ol> <p>这个流程中，如果我们的并发任务很多，频繁的去新建线程和销毁线程是非常消耗我们的资源和时间的。这个时候就提出了将线程与池相结合，在一个池子里面放一些线程，用的时候从里面取出来，不用的时候放回去，通过保持一定数量的线程来节省我们新建线程和销毁线程的开销，这就是线程池。</p> <h3 id="线程池的优点"><a href="#线程池的优点" class="header-anchor">#</a> 线程池的优点</h3> <ol><li>复用已经创建的线程，节省创建/销毁线程的开销</li> <li>控制并发的数量，避免因并发线程数过多导致崩溃（主要原因）</li> <li>可以对线程进行统一管理</li></ol> <h3 id="java中的线程池"><a href="#java中的线程池" class="header-anchor">#</a> Java中的线程池</h3> <p>Java中的线程池顶层接口是Executor接口，ThreadPoolExecutor是这个接口的实现类，我们可以通过ThreadPoolExecutor来使用线程池。</p> <h3 id="特殊名词"><a href="#特殊名词" class="header-anchor">#</a> 特殊名词</h3> <ul><li>核心线程：线程池中分为核心线程和非核心线程，核心线程是常驻于线程池中，默认即使没有任务也不会被销毁的线程，非核心线程长时间闲置则会被销毁。</li> <li>阻塞队列：线程池中用于保存等待执行的Runnable任务对象的队列。</li></ul> <h3 id="threadpoolexecutor构造器"><a href="#threadpoolexecutor构造器" class="header-anchor">#</a> ThreadPoolExecutor构造器</h3> <p>ThreadPoolExecutor有4个构造器，分别有5-7个参数，所有的参数如下，</p> <p>必要参数：</p> <ul><li>int corePoolSize：该线程池中核心线程数最大值。</li> <li>int maximumPoolSize：该线程池中线程总数最大值 。</li> <li>long keepAliveTime：非核心线程闲置超时时长。</li> <li>TimeUnit unit：keepAliveTime的单位。
<blockquote><p>包含如下单位： NANOSECONDS(微毫秒)，MICROSECONDS(微秒)，MILLISECONDS(毫秒)，SECONDS(秒)，MINUTES(分)，HOURS(小时)，DAYS(天)。</p></blockquote></li> <li>BlockingQueue workQueue：阻塞队列，维护着等待执行的Runnable任务对象。
<blockquote><p>常用的几个阻塞队列：</p> <ul><li>LinkedBlockingQueue：链式阻塞队列，底层数据结构是链表，默认大小是Integer.MAX_VALUE，也可以指定大小。</li> <li>ArrayBlockingQueue：数组阻塞队列，底层数据结构是数组，需要指定队列的大小。</li> <li>SynchronousQueue：同步队列，内部容量为0，每个put操作必须等待一个take操作，反之亦然。</li> <li>DelayQueue：延迟队列，该队列中的元素只有当其指定的延迟时间到了，才能够从队列中获取到该元素 。</li></ul></blockquote></li></ul> <p>非必要参数：</p> <ul><li>ThreadFactory threadFactory：创建线程的工厂 ，用于批量创建线程，统一在创建线程时设置一些参数，如是否守护线程、线程的优先级等。如果不指定，会新建一个默认的线程工厂。</li> <li>RejectedExecutionHandler handler：拒绝处理策略，线程数量大于最大线程数就会采用拒绝处理策略。
<blockquote><p>包含如下四种拒绝处理的策略：</p> <ul><li>ThreadPoolExecutor.AbortPolicy：默认拒绝处理策略，丢弃任务并抛出RejectedExecutionException异常。</li> <li>ThreadPoolExecutor.DiscardPolicy：丢弃新来的任务，但是不抛出异常。</li> <li>ThreadPoolExecutor.DiscardOldestPolicy：丢弃队列头部（最旧的）的任务，然后重新尝试执行程序（如果再次失败，重复此过程）。</li> <li>ThreadPoolExecutor.CallerRunsPolicy：由调用线程处理该任务。</li></ul></blockquote></li></ul> <h3 id="threadpoolexecutor状态"><a href="#threadpoolexecutor状态" class="header-anchor">#</a> ThreadPoolExecutor状态</h3> <p>因为ThreadPoolExecutor本身也是由一个调度线程来对整个线程池进行调度管理的，所以线程池自己也有状态。ThreadPoolExecutor类中定义了一个<code>volatile int</code>变量<code>runState</code>来表示线程池的状态 ，共有5种，分别为：</p> <ul><li>RUNNING：线程池创建后处于RUNNING状态。</li> <li>SHUTDOWN：调用shutdown()方法后处于SHUTDOWN状态，线程池不能接受新的任务，清除一些空闲worker,会等待阻塞队列的任务完成。</li> <li>STOP：调用shutdownNow()方法后处于STOP状态，线程池不能接受新的任务，中断所有线程，阻塞队列中没有被执行的任务全部丢弃。此时，poolsize=0,阻塞队列的size也为0。</li> <li>TIDYING：当所有的任务已终止，ctl记录的”任务数量”为0，线程池会变为TIDYING状态。接着会执行terminated()函数。
<blockquote><p>ThreadPoolExecutor中有一个控制状态的属性叫ctl，它是一个AtomicInteger类型的变量。</p></blockquote></li> <li>TERMINATED：线程池处在TIDYING状态时，执行完terminated()方法之后，就会由 TIDYING -&gt; TERMINATED， 线程池被设置为TERMINATED状态。</li></ul> <h3 id="threadpoolexecutor处理流程"><a href="#threadpoolexecutor处理流程" class="header-anchor">#</a> ThreadPoolExecutor处理流程</h3> <ol><li>执行任务时，先判断当前线程池中线程数是否达到了corePoolSize，若小于则创建新的核心线程并添加当前任务至新建的核心线程中。</li> <li>若线程池中线程数 &gt;= corePoolSize，则不再创建新的核心线程，将任务直接放入任务阻塞队列，等待核心线程执行完任务以后回队列取出新的任务执行（复用）。</li> <li>当任务阻塞队列满了时，表明当前核心线程数已经不够使用了，则会创建非核心线程来处理任务。</li> <li>若当前线程总数（核心线程数+非核心线程）达到了maximumPoolSize且任务队列满了，则开始使用拒绝策略处理多余的任务。</li></ol> <blockquote><p>注意，不管是创建核心线程还是非核心线程，都需要获取到ThreadPoolExecutor的全局锁。</p></blockquote> <h3 id="_4种常见线程池"><a href="#_4种常见线程池" class="header-anchor">#</a> 4种常见线程池</h3> <p>在<code>Executors</code>类中提供了创建4种线程池静态方法，供我们直接调用创建指定的线程池。</p> <ul><li><p>newCachedThreadPool</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                  <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                  <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>corePoolSize大小为0，没有核心线程</li> <li>线程池最大为Integer.MAX_VALUE</li> <li>非核心线程过期时间60s</li> <li>使用同步队列存储任务，任务池中只存放一个任务，再放入任务需阻塞</li></ol> <p>因为线程会在60s内销毁，所以线程在执行一些短时间任务的时候复用率会比较高，性能较好。且由于没有核心线程且非核心线程60s闲置便会过期，线程池在空闲的时候不会占用很多资源。因为线程池特别大，几乎不会触发拒绝策略。</p></li> <li><p>newFixedThreadPool</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>
                                    <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>corePoolSize = maximumPoolSize，池中所有的线程都是核心线程</li> <li>线程不过期</li> <li>使用链式阻塞队列存储任务</li></ol> <p>线程池中所有的线程都是核心线程，不会被销毁，任务队列使用链式阻塞队列存储，基本没有上限。所以适合处理长期固定一直有任务需要处理的情况，需要特别注意的是因为线程不会被销毁，比较占用资源。也几乎不会触发拒绝策略，因为任务队列很大。</p></li> <li><p>newSingleThreadExecutor</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
    <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                            <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>corePoolSize = maximumPoolSize = 1, 线程池中只有一个核心线程</li> <li>线程不过期</li> <li>使用链式阻塞队列存储任务</li></ol> <p>线程池只有一个处理任务的核心线程，任务都需要在队列中等待唯一的核心线程处理完毕以后来获取。</p></li> <li><p>newScheduledThreadPool</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ScheduledExecutorService</span> <span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ScheduledThreadPoolExecutor</span><span class="token punctuation">(</span>corePoolSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">ScheduledThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>corePoolSize<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
          DEFAULT_KEEPALIVE_MILLIS<span class="token punctuation">,</span> MILLISECONDS<span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">DelayedWorkQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>指定长度的corePoolSize</li> <li>线程池长度为Integer.MAX_VALUE</li> <li>使用延迟阻塞队列存储任务</li></ol> <p>该线程池主要的特性是使用延迟阻塞队列存储任务，故可以周期性的定时执行任务队列中的任务。</p> <blockquote><p>虽然<code>Executors</code>提供了以上4种线程池，但是<strong>阿里巴巴JAVA开发手册</strong>规定了需自己使用<code>ThreadPoolExecutor</code>自行创建需要的线程池，这样可以让程序员自行创建出符合要求的线程池，让资源消耗在我们的掌控之中，避免因线程池或任务队列设置成<code>Integer.MAX_VALUE</code>后发生一些资源耗尽的情况。</p></blockquote></li></ul> <h3 id="使用threadpoolexcutor"><a href="#使用threadpoolexcutor" class="header-anchor">#</a> 使用ThreadPoolExcutor</h3> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicInteger</span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 新建一个核心线程数10，最大线程数20的线程池</span>
        <span class="token class-name">ThreadPoolExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>
                <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> executor<span class="token punctuation">.</span><span class="token function">getMaximumPoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 调用线程池的execute方法，放入任务</span>
            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                i<span class="token punctuation">.</span><span class="token function">addAndGet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 调用线程池的submit方法，放入任务</span>
            <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FutureTask</span><span class="token punctuation">)</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> i<span class="token punctuation">.</span><span class="token function">addAndGet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// submit方法不同于execute方法，submit有返回值FutureTask类，调用get方法即可获取线程执行任务的结果</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java-learning/multi-thread/principle.html" class="prev">
        多线程原理
      </a></span> <span class="next"><a href="/java-learning/design-pattern/singleton.html">
        创建型-单例模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/java-learning/assets/js/app.046a40f3.js" defer></script><script src="/java-learning/assets/js/2.cb888cbe.js" defer></script><script src="/java-learning/assets/js/28.9fa67906.js" defer></script>
  </body>
</html>
