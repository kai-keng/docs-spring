<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Explain（执行计划）字段解析 | Java</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just record my learning process">
    <link rel="preload" href="/java-learning/assets/css/0.styles.dcc29016.css" as="style"><link rel="preload" href="/java-learning/assets/js/app.1901dd43.js" as="script"><link rel="preload" href="/java-learning/assets/js/2.073b9d23.js" as="script"><link rel="preload" href="/java-learning/assets/js/3.9a561856.js" as="script"><link rel="prefetch" href="/java-learning/assets/js/10.dad40421.js"><link rel="prefetch" href="/java-learning/assets/js/11.ce128f48.js"><link rel="prefetch" href="/java-learning/assets/js/12.e9b9ebbb.js"><link rel="prefetch" href="/java-learning/assets/js/13.5e673bfe.js"><link rel="prefetch" href="/java-learning/assets/js/14.2a5fb8ee.js"><link rel="prefetch" href="/java-learning/assets/js/15.0557d9da.js"><link rel="prefetch" href="/java-learning/assets/js/16.cea1ad05.js"><link rel="prefetch" href="/java-learning/assets/js/17.925059d9.js"><link rel="prefetch" href="/java-learning/assets/js/18.41bf69ff.js"><link rel="prefetch" href="/java-learning/assets/js/19.1fa04d72.js"><link rel="prefetch" href="/java-learning/assets/js/20.603c38b3.js"><link rel="prefetch" href="/java-learning/assets/js/21.e413be99.js"><link rel="prefetch" href="/java-learning/assets/js/22.ea64d9c6.js"><link rel="prefetch" href="/java-learning/assets/js/23.75a31ea2.js"><link rel="prefetch" href="/java-learning/assets/js/24.40e425c2.js"><link rel="prefetch" href="/java-learning/assets/js/25.ddd92ca4.js"><link rel="prefetch" href="/java-learning/assets/js/26.30915e39.js"><link rel="prefetch" href="/java-learning/assets/js/27.1c256433.js"><link rel="prefetch" href="/java-learning/assets/js/28.450f5c1a.js"><link rel="prefetch" href="/java-learning/assets/js/29.a046e6c3.js"><link rel="prefetch" href="/java-learning/assets/js/30.e6ae58bf.js"><link rel="prefetch" href="/java-learning/assets/js/31.0c707e95.js"><link rel="prefetch" href="/java-learning/assets/js/32.2aaaaffa.js"><link rel="prefetch" href="/java-learning/assets/js/33.035dfa95.js"><link rel="prefetch" href="/java-learning/assets/js/34.9c460ede.js"><link rel="prefetch" href="/java-learning/assets/js/35.5288aa94.js"><link rel="prefetch" href="/java-learning/assets/js/36.60128c6c.js"><link rel="prefetch" href="/java-learning/assets/js/37.eef08c7a.js"><link rel="prefetch" href="/java-learning/assets/js/38.22961b1e.js"><link rel="prefetch" href="/java-learning/assets/js/39.ec3479b5.js"><link rel="prefetch" href="/java-learning/assets/js/4.121edae5.js"><link rel="prefetch" href="/java-learning/assets/js/40.2d9de629.js"><link rel="prefetch" href="/java-learning/assets/js/41.e7ec9137.js"><link rel="prefetch" href="/java-learning/assets/js/42.6852d284.js"><link rel="prefetch" href="/java-learning/assets/js/43.43de6cec.js"><link rel="prefetch" href="/java-learning/assets/js/44.1ebb78f6.js"><link rel="prefetch" href="/java-learning/assets/js/45.97fbdcac.js"><link rel="prefetch" href="/java-learning/assets/js/46.b6bca0f5.js"><link rel="prefetch" href="/java-learning/assets/js/47.0e834db6.js"><link rel="prefetch" href="/java-learning/assets/js/48.a013613d.js"><link rel="prefetch" href="/java-learning/assets/js/49.2f32e19b.js"><link rel="prefetch" href="/java-learning/assets/js/5.56aeef71.js"><link rel="prefetch" href="/java-learning/assets/js/50.a5c72d35.js"><link rel="prefetch" href="/java-learning/assets/js/51.4fb9ca64.js"><link rel="prefetch" href="/java-learning/assets/js/52.95a10627.js"><link rel="prefetch" href="/java-learning/assets/js/53.0d3efd34.js"><link rel="prefetch" href="/java-learning/assets/js/54.159b44a9.js"><link rel="prefetch" href="/java-learning/assets/js/55.7e9c2224.js"><link rel="prefetch" href="/java-learning/assets/js/56.66727fd2.js"><link rel="prefetch" href="/java-learning/assets/js/57.3df933e0.js"><link rel="prefetch" href="/java-learning/assets/js/58.46f7ca5e.js"><link rel="prefetch" href="/java-learning/assets/js/59.308cd70d.js"><link rel="prefetch" href="/java-learning/assets/js/6.6f342fa7.js"><link rel="prefetch" href="/java-learning/assets/js/60.e0deab68.js"><link rel="prefetch" href="/java-learning/assets/js/61.f38d14ae.js"><link rel="prefetch" href="/java-learning/assets/js/62.513930b7.js"><link rel="prefetch" href="/java-learning/assets/js/63.196964c3.js"><link rel="prefetch" href="/java-learning/assets/js/64.e0e07320.js"><link rel="prefetch" href="/java-learning/assets/js/65.330531b2.js"><link rel="prefetch" href="/java-learning/assets/js/66.bf670686.js"><link rel="prefetch" href="/java-learning/assets/js/67.a9a6f917.js"><link rel="prefetch" href="/java-learning/assets/js/68.84c5d627.js"><link rel="prefetch" href="/java-learning/assets/js/69.69d15b7c.js"><link rel="prefetch" href="/java-learning/assets/js/7.10be025d.js"><link rel="prefetch" href="/java-learning/assets/js/70.c46573b2.js"><link rel="prefetch" href="/java-learning/assets/js/71.a7682bcc.js"><link rel="prefetch" href="/java-learning/assets/js/72.ffc2d0fe.js"><link rel="prefetch" href="/java-learning/assets/js/73.6327692b.js"><link rel="prefetch" href="/java-learning/assets/js/74.c489944f.js"><link rel="prefetch" href="/java-learning/assets/js/8.22a01c81.js"><link rel="prefetch" href="/java-learning/assets/js/9.76ea7ae1.js">
    <link rel="stylesheet" href="/java-learning/assets/css/0.styles.dcc29016.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-learning/" class="home-link router-link-active"><!----> <span class="site-name">Java</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/spring-boot/" class="sidebar-heading clickable"><span>Spring Boot</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/spring-cloud/" class="sidebar-link">Spring Cloud</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/mysql/" class="sidebar-heading clickable router-link-active open"><span>MySQL</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-learning/mysql/mysql-index.html" class="sidebar-link">索引</a></li><li><a href="/java-learning/mysql/datatype.html" class="sidebar-link">数据类型</a></li><li><a href="/java-learning/mysql/transaction.html" class="sidebar-link">事务（Transaction）</a></li><li><a href="/java-learning/mysql/explain.html" aria-current="page" class="active sidebar-link">Explain（执行计划）字段解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#id" class="sidebar-link">id</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#select-type" class="sidebar-link">select_type</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#table" class="sidebar-link">table</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#type" class="sidebar-link">type</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#possible-keys-与-key" class="sidebar-link">possible_keys 与 key</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#key-len" class="sidebar-link">key_len</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#ref" class="sidebar-link">ref</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#rows" class="sidebar-link">rows</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#extra" class="sidebar-link">Extra</a></li><li class="sidebar-sub-header"><a href="/java-learning/mysql/explain.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/java-learning/mysql/sql-optimization.html" class="sidebar-link">SQL 优化</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/collection/" class="sidebar-heading clickable"><span>集合框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/jvm/" class="sidebar-heading clickable"><span>JVM</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/multi-thread/" class="sidebar-heading clickable"><span>多线程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/design-pattern/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/internet/" class="sidebar-link">网络</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/other/" class="sidebar-heading clickable"><span>其他</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/materials/" class="sidebar-link">相关资料</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="explain（执行计划）字段解析"><a href="#explain（执行计划）字段解析" class="header-anchor">#</a> Explain（执行计划）字段解析</h1> <p>使用EXPLAIN关键字可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。分析你的查询语句或是表结构的性能瓶颈。</p> <p>执行计划分析结果中包含有很多字段，各字段代表含义如下：</p> <h2 id="id"><a href="#id" class="header-anchor">#</a> id</h2> <p>select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序。</p> <p>如果在语句中没有子查询或关联查询，只有唯一的select，每行都将显示1.否则，内层的select语句一般会顺序编号，对应于其在原始语句中的位置。</p> <p>id的结果共有3中情况:</p> <ul><li>id相同，执行顺序由上至下</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report<span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-1.b8baabb7.jpg" alt="explain-1"></p> <ul><li>id不同，如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-2.b58abf3b.jpg" alt="explain-2"></p> <ul><li>id相同不同，同时存在，与上面一样，同id从上往下执行，id越大优先级越高</li></ul> <h2 id="select-type"><a href="#select-type" class="header-anchor">#</a> select_type</h2> <p>用来表示查询的类型，主要是用于区别普通查询、联合查询、子查询等的复杂查询。所有的值如下：</p> <ul><li>SIMPLE：简单的 SELECT 查询，查询中<strong>不包含子查询或者 UNION</strong>。</li> <li>PRIMARY：PRIMARY 查询中若包含<strong>任何复杂的子部分</strong>，<strong>最外层查询</strong>则被标记为 PRIMARY。</li> <li>SUBQUERY：在 SELECT 或 WHERE 列表中<strong>包含了子查询</strong>。</li> <li>DERIVED：在 <strong>FROM 列表中包含的子查询</strong>被标记为 DERIVED（衍生），MySQL 会递归执行这些子查询，把结果放在临时表中。</li> <li>UNION：若第二个 SELECT 出现在 UNION 之后，则被标记为 UNION。若 UNION 包含在 FROM 子句的子查询中，外层 SELECT 将被标记为 DERIVED。</li> <li>UNION RESULT：从 UNION 表获取结果的 SELECT。</li></ul> <p><img src="/java-learning/assets/img/explain-2.b58abf3b.jpg" alt="explain-2"></p> <h2 id="table"><a href="#table" class="header-anchor">#</a> table</h2> <p>指的是当前执行引用哪个表。</p> <p><img src="/java-learning/assets/img/explain-1.b8baabb7.jpg" alt="explain-1"></p> <h2 id="type"><a href="#type" class="header-anchor">#</a> type</h2> <p>type所显示的是查询使用了哪种类型，type包含的类型包括如下几种：</p> <ul><li><p>system：表只有一行记录，这是const类型的特列，平时不会出现，可忽略不计。</p></li> <li><p>const：表示只通过一次索引便找到了数据，常出现与主键或唯一索引与常量值比较的场景，此时性能最佳。</p></li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-3.bed9eb95.jpg" alt="explain-3"></p> <ul><li>eq_ref：唯一性索引扫描，对于每个索引键，表中只有一条记录匹配。常见于主键或非空唯一索引，比如两张表使用主键连表时，就是 eq_ref。</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r<span class="token punctuation">,</span> <span class="token keyword">user</span> <span class="token keyword">as</span> u <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>id <span class="token operator">=</span> u<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-4.845d6eb6.jpg" alt="explain-4"></p> <ul><li>ref：非唯一性索引扫描，即刚好与 eq_ref 相反，使用非主键和唯一索引匹配指定值的时候，使用的就是 ref。</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token comment">-- type_name为非唯一索引</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>type_name <span class="token operator">=</span> <span class="token string">'测试数据'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-5.52a2a9ac.jpg" alt="explain-5"></p> <ul><li><p>ref_or_null：与 ref 类似，附加了对 NULL 值列的查询。</p></li> <li><p>index_merge：索引合并，当我们查询条件使用了多个索引字段进行 OR，AND 操作的时候会进行索引合并，将索引各自的结果值进行合并。</p></li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">OR</span> r<span class="token punctuation">.</span>ext_id <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-6.cfd2d0cb.jpg" alt="explain-6"></p> <ul><li>range：范围索引扫描，检索指定范围的索引。一般出现于条件语句中有 between，&lt;，&gt;，in 等查询的时候，性能优于全索引扫描。</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>id <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-7.1c2eb422.jpg" alt="explain-7"></p> <ul><li>index：全索引扫描，遍历所有索引，相比于全表扫描较好，但是也算是性能比较差的级别了，常见于无条件查询<a href="https://kai-keng.github.io/java-learning/mysql/mysql-index.html#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89" target="_blank" rel="noopener noreferrer">覆盖索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的情况。</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r<span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-8.ab27ad4a.jpg" alt="explain-8"></p> <ul><li>all：全表扫描，最差的情况，会扫描整张表，查询效率很低。</li></ul> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>type_id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-9.44ce4233.jpg" alt="explain-9"></p> <blockquote><p>注意，阿里巴巴JAVA开发手册中规定，我们书写的 SQL 至少要达到 range 级别，要求是 ref 级别。</p></blockquote> <h2 id="possible-keys-与-key"><a href="#possible-keys-与-key" class="header-anchor">#</a> possible_keys 与 key</h2> <p>possible_keys 表示哪些索引可以应用到此次查询中用于优化，key 表示 MySQL 实际使用的索引。若执行计划 key 为非空则表示使用了索引，反之表示未使用到索引。</p> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span> r<span class="token punctuation">.</span>id <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-10.c290587f.jpg" alt="explain-10"></p> <p>上图中 possible_keys 为 <code>PRIMARY,idx_create_time</code>，key 为 <code>PRIMARY</code>。表示可以使用的索引有<strong>主键索引和 idx_create_time 索引</strong>，实际使用的是<strong>主键索引</strong>。</p> <h2 id="key-len"><a href="#key-len" class="header-anchor">#</a> key_len</h2> <p>表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度，长度越长查询精度越高，<strong>但是在不损失精确性的情况下，长度越短越好</strong>（涉及 B+树原理，长度越短能减低树的深度，减少 io 次数，提高性能）。key_len 显示的值为索引字段的最大可能长度，并非实际使用长度，即 key_len 是根据表定义计算而得，不是通过表内检索出的。</p> <h2 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h2> <p>显示索引的那一列被使用了，如果可能的话，最好是一个常数。哪些列或常量被用于查找索引列上的值。</p> <h2 id="rows"><a href="#rows" class="header-anchor">#</a> rows</h2> <p>根据表统计信息及索引选用情况，大致估算出找到所需的记录所需要读取的行数，也就是说，用的越少越好。</p> <h2 id="extra"><a href="#extra" class="header-anchor">#</a> Extra</h2> <p>Extra 列主要用于显示额外的信息，常见信息及其含义如下：</p> <ul><li><p>Using where: 表示 MySQL 服务器在存储引擎收到记录后使用了 where 条件进行过滤。</p></li> <li><p>Using filesort：表示MySQL不会按照表内索引顺序读取，会使用外部索引排序。在MySQL中无法利用索引完成的排序操作被称为<strong>文件排序</strong>。</p></li> <li><p>Using temporary：表示使用了临时表保存中间结果。MySQL在对查询结果排序或分组是使用了临时表，常见于 <code>ORDER BY</code> 与 <code>GROUP BY</code>。</p></li> <li><p>Using index：表示查询中使用了<a href="https://kai-keng.github.io/java-learning/mysql/mysql-index.html#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89" target="_blank" rel="noopener noreferrer">覆盖索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，避免了回表查询。但是有时会与 <code>Using where</code> 同时出现，表示非直接查询<a href="https://kai-keng.github.io/java-learning/mysql/mysql-index.html#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89" target="_blank" rel="noopener noreferrer">覆盖索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>数据，并且索引被用来执行索引值的查找。通俗来讲就是只有 <code>Using index</code> 的时候表示只是简单查询<a href="https://kai-keng.github.io/java-learning/mysql/mysql-index.html#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89" target="_blank" rel="noopener noreferrer">覆盖索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，同时出现则表示还使用了索引作为查询项查询过滤。</p> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> ext_id <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span>  ext_id <span class="token operator">!=</span> <span class="token string">'4028e5f661e121980161ef964e7d106e'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-12.3b700cbe.jpg" alt="explain-12"></p></li> <li><p>Using index condition：MySQL5.6 版本后新加入的，表示先对索引值进行了过滤，过滤后会找到所有的数据行（回表），如果同时有 <code>Using where</code>，则会在找到数据行以后再使用 where 过滤。</p> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> ext_id <span class="token keyword">FROM</span> report <span class="token keyword">as</span> r <span class="token keyword">WHERE</span>  ext_id <span class="token operator">!=</span> <span class="token string">'4028e5f661e121980161ef964e7d106e'</span> <span class="token operator">AND</span> author_id <span class="token operator">!=</span> <span class="token string">&quot;1&quot;</span> <span class="token punctuation">;</span>
</code></pre></div><p><img src="/java-learning/assets/img/explain-11.87db3bd8.jpg" alt="explain-11"></p></li> <li><p>Using join buffer：表明表连接的时候使用了连接缓存。</p></li> <li><p>impossible where：表明 where 查询的值总是 false，无法用来查询到确切数据。</p></li></ul> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ol><li><a href="https://www.php.cn/mysql-tutorials-454417.html" target="_blank" rel="noopener noreferrer">MySQL中explain用法和结果分析（详解）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/6844904135964229646#heading-1" target="_blank" rel="noopener noreferrer">没内鬼，来点干货！SQL优化和诊断<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java-learning/mysql/transaction.html" class="prev">
        事务（Transaction）
      </a></span> <span class="next"><a href="/java-learning/mysql/sql-optimization.html">
        SQL 优化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/java-learning/assets/js/app.1901dd43.js" defer></script><script src="/java-learning/assets/js/2.073b9d23.js" defer></script><script src="/java-learning/assets/js/3.9a561856.js" defer></script>
  </body>
</html>
