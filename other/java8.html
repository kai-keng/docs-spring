<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java8 新特性 | Java</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just record my learning process">
    <link rel="preload" href="/java-learning/assets/css/0.styles.dcc29016.css" as="style"><link rel="preload" href="/java-learning/assets/js/app.cce1b4e5.js" as="script"><link rel="preload" href="/java-learning/assets/js/2.073b9d23.js" as="script"><link rel="preload" href="/java-learning/assets/js/61.e51cee88.js" as="script"><link rel="prefetch" href="/java-learning/assets/js/10.dad40421.js"><link rel="prefetch" href="/java-learning/assets/js/11.ce128f48.js"><link rel="prefetch" href="/java-learning/assets/js/12.e9b9ebbb.js"><link rel="prefetch" href="/java-learning/assets/js/13.cd90e4cd.js"><link rel="prefetch" href="/java-learning/assets/js/14.2eeb1f09.js"><link rel="prefetch" href="/java-learning/assets/js/15.a8802938.js"><link rel="prefetch" href="/java-learning/assets/js/16.1629ef5d.js"><link rel="prefetch" href="/java-learning/assets/js/17.925059d9.js"><link rel="prefetch" href="/java-learning/assets/js/18.41bf69ff.js"><link rel="prefetch" href="/java-learning/assets/js/19.1fa04d72.js"><link rel="prefetch" href="/java-learning/assets/js/20.603c38b3.js"><link rel="prefetch" href="/java-learning/assets/js/21.e413be99.js"><link rel="prefetch" href="/java-learning/assets/js/22.da4de311.js"><link rel="prefetch" href="/java-learning/assets/js/23.72b01e86.js"><link rel="prefetch" href="/java-learning/assets/js/24.9af2598a.js"><link rel="prefetch" href="/java-learning/assets/js/25.ddd92ca4.js"><link rel="prefetch" href="/java-learning/assets/js/26.30915e39.js"><link rel="prefetch" href="/java-learning/assets/js/27.1c256433.js"><link rel="prefetch" href="/java-learning/assets/js/28.450f5c1a.js"><link rel="prefetch" href="/java-learning/assets/js/29.a046e6c3.js"><link rel="prefetch" href="/java-learning/assets/js/3.9a561856.js"><link rel="prefetch" href="/java-learning/assets/js/30.e6ae58bf.js"><link rel="prefetch" href="/java-learning/assets/js/31.0c707e95.js"><link rel="prefetch" href="/java-learning/assets/js/32.2aaaaffa.js"><link rel="prefetch" href="/java-learning/assets/js/33.035dfa95.js"><link rel="prefetch" href="/java-learning/assets/js/34.9c460ede.js"><link rel="prefetch" href="/java-learning/assets/js/35.5288aa94.js"><link rel="prefetch" href="/java-learning/assets/js/36.60128c6c.js"><link rel="prefetch" href="/java-learning/assets/js/37.eef08c7a.js"><link rel="prefetch" href="/java-learning/assets/js/38.22961b1e.js"><link rel="prefetch" href="/java-learning/assets/js/39.ec3479b5.js"><link rel="prefetch" href="/java-learning/assets/js/4.121edae5.js"><link rel="prefetch" href="/java-learning/assets/js/40.2d9de629.js"><link rel="prefetch" href="/java-learning/assets/js/41.e7ec9137.js"><link rel="prefetch" href="/java-learning/assets/js/42.6852d284.js"><link rel="prefetch" href="/java-learning/assets/js/43.43de6cec.js"><link rel="prefetch" href="/java-learning/assets/js/44.1ebb78f6.js"><link rel="prefetch" href="/java-learning/assets/js/45.97fbdcac.js"><link rel="prefetch" href="/java-learning/assets/js/46.b6bca0f5.js"><link rel="prefetch" href="/java-learning/assets/js/47.0e834db6.js"><link rel="prefetch" href="/java-learning/assets/js/48.a013613d.js"><link rel="prefetch" href="/java-learning/assets/js/49.2f32e19b.js"><link rel="prefetch" href="/java-learning/assets/js/5.9c9b10b1.js"><link rel="prefetch" href="/java-learning/assets/js/50.a5c72d35.js"><link rel="prefetch" href="/java-learning/assets/js/51.4fb9ca64.js"><link rel="prefetch" href="/java-learning/assets/js/52.95a10627.js"><link rel="prefetch" href="/java-learning/assets/js/53.0d3efd34.js"><link rel="prefetch" href="/java-learning/assets/js/54.159b44a9.js"><link rel="prefetch" href="/java-learning/assets/js/55.7e9c2224.js"><link rel="prefetch" href="/java-learning/assets/js/56.66727fd2.js"><link rel="prefetch" href="/java-learning/assets/js/57.3df933e0.js"><link rel="prefetch" href="/java-learning/assets/js/58.46f7ca5e.js"><link rel="prefetch" href="/java-learning/assets/js/59.905d8f03.js"><link rel="prefetch" href="/java-learning/assets/js/6.6f342fa7.js"><link rel="prefetch" href="/java-learning/assets/js/60.e0deab68.js"><link rel="prefetch" href="/java-learning/assets/js/62.be3edbae.js"><link rel="prefetch" href="/java-learning/assets/js/63.6ed84f94.js"><link rel="prefetch" href="/java-learning/assets/js/64.fbd48c80.js"><link rel="prefetch" href="/java-learning/assets/js/65.f26d0572.js"><link rel="prefetch" href="/java-learning/assets/js/66.fb6c4361.js"><link rel="prefetch" href="/java-learning/assets/js/67.823abbfa.js"><link rel="prefetch" href="/java-learning/assets/js/68.0672442c.js"><link rel="prefetch" href="/java-learning/assets/js/69.ca59db09.js"><link rel="prefetch" href="/java-learning/assets/js/7.2a3e44a6.js"><link rel="prefetch" href="/java-learning/assets/js/70.5dc66259.js"><link rel="prefetch" href="/java-learning/assets/js/71.7b26e040.js"><link rel="prefetch" href="/java-learning/assets/js/72.6b41145a.js"><link rel="prefetch" href="/java-learning/assets/js/8.f268628b.js"><link rel="prefetch" href="/java-learning/assets/js/9.76ea7ae1.js">
    <link rel="stylesheet" href="/java-learning/assets/css/0.styles.dcc29016.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-learning/" class="home-link router-link-active"><!----> <span class="site-name">Java</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kai-keng.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/spring-boot/" class="sidebar-heading clickable"><span>Spring Boot</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/spring-cloud/" class="sidebar-link">Spring Cloud</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/mysql/" class="sidebar-heading clickable"><span>MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/collection/" class="sidebar-heading clickable"><span>集合框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/jvm/" class="sidebar-heading clickable"><span>JVM</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/multi-thread/" class="sidebar-heading clickable"><span>多线程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/design-pattern/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/java-learning/internet/" class="sidebar-link">网络</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/java-learning/other/" class="sidebar-heading clickable router-link-active open"><span>其他</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-learning/other/java8.html" aria-current="page" class="active sidebar-link">Java8 新特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#lambda" class="sidebar-link">Lambda</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#lambda-表达式注意点" class="sidebar-link">Lambda 表达式注意点</a></li></ul></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#方法引用" class="sidebar-link">方法引用</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#函数式接口" class="sidebar-link">函数式接口</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#stream（流）" class="sidebar-link">Stream（流）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#流的操作" class="sidebar-link">流的操作</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#操作详细介绍" class="sidebar-link">操作详细介绍</a></li></ul></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#optional" class="sidebar-link">Optional</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#创建-optional" class="sidebar-link">创建 Optional</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#处理-optional" class="sidebar-link">处理 Optional</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#获取-optional-值" class="sidebar-link">获取 Optional 值</a></li></ul></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#新日期时间" class="sidebar-link">新日期时间</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#常用时间类" class="sidebar-link">常用时间类</a></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#时间转换" class="sidebar-link">时间转换</a></li></ul></li><li class="sidebar-sub-header"><a href="/java-learning/other/java8.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/java-learning/other/distributed-lock.html" class="sidebar-link">分布式锁</a></li></ul></section></li><li><a href="/java-learning/materials/" class="sidebar-link">相关资料</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="java8-新特性"><a href="#java8-新特性" class="header-anchor">#</a> Java8 新特性</h1> <p>Java8 版本发布了许多的新特性，而且是非常实用的新特性，利用好这些新特性能够加快我们的编程效率，让代码更加的美观简洁。</p> <h2 id="lambda"><a href="#lambda" class="header-anchor">#</a> Lambda</h2> <p>Lambda 表达式可以理解为一种匿名函数的写法，类似 JavaScript 中的箭头函数。分为<strong>参数</strong>、<strong>箭头</strong>与<strong>函数体</strong>3部分，比如这个 Lambda 表达式：</p> <p><code>(a, b) -&gt; { System.out.println(a + b); }</code></p> <ul><li><p><strong>参数</strong></p> <p>表达式中 <code>(a, b)</code> 为参数部分，若参数只有一个时可以简写为 <code>a -&gt; { System.out.println(a); }</code>，也可不传参数留空括号 <code>() -&gt; { System.out.println(&quot;Test&quot;); }</code>。</p></li> <li><p><strong>箭头</strong></p> <p>即中间的箭头 <code>-&gt;</code>。</p></li> <li><p><strong>函数体</strong></p> <p>函数体指箭头后面的部分 <code>{ System.out.println(a + b); }</code>。当函数体内直接返回某个值时 <code>a -&gt; { return a; }</code>，可以省略外面的大括号，直接写作 <code>a -&gt; a</code>。</p></li></ul> <h3 id="lambda-表达式注意点"><a href="#lambda-表达式注意点" class="header-anchor">#</a> Lambda 表达式注意点</h3> <ul><li><p>Lambda 表达式中若引用局部变量，那么该局部变量必须用 final 修饰（若你没有使用 final 修饰，编译器会默认隐式的帮你加上）。</p> <p>因为局部变量是存放在栈内存中的，是线程私有的，当线程执行完成以后 GC 就会回收掉。但是 Lambda 表达式会被处理成使用额外的线程去执行，与创建局部变量的线程非同一线程，若拥有变量的线程执行完毕被销毁了，Lambda 表达式将无法获取到该变量。所以 Lambda 表达式中使用的局部变量都是原变量的一个拷贝，为了确保拷贝值与原值一定相同，所以要声明为 final 类型，避免修改。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">// 表达式中的i编译器会报错，要求你创建一个使用fianl修饰的变量</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 若去掉改行赋值，编译器不会报错，i变量会被隐式的加上final</span>
    i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="方法引用"><a href="#方法引用" class="header-anchor">#</a> 方法引用</h2> <p>方法引用可以看做是一种简化的 Lambda 表达式，当你的 Lambda 表达式只是简单的调用某个方法时，可以使用方法引用代替。比如：</p> <p>Lambda 写法：<code>(Integer i) -&gt; i.toString()</code></p> <p>方法引用写法：<code>Object::toString</code></p> <blockquote><p>注意：此处不写成 <code>Integer::toString</code> 或 <code>i::toString</code>，编译器会报错。因为 Integer 中有个静态的 toString 方法，也有
实例的 toString 方法，编译器无法确定使用哪个，所以会报错。</p></blockquote> <p>方法引用共有三种不同的形式，分别是：</p> <ul><li><p><strong>类::静态方法</strong>：<code>Integer::compare</code></p></li> <li><p><strong>类::非静态方法</strong>：<code>Object::toString</code></p></li> <li><p><strong>实例::非静态方法</strong>：<code>i::equals</code></p></li></ul> <h2 id="函数式接口"><a href="#函数式接口" class="header-anchor">#</a> 函数式接口</h2> <p>函数式接口指的是之定义了一个抽象方法的接口，并使用 <code>@FunctionalInterface</code> 标记。比如：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
  <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">T</span> o1<span class="token punctuation">,</span> <span class="token class-name">T</span> o2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注意：接口中的默认（default）方法并不属于抽象方法，且用于重写超类 Object 类中的方法也不属于抽象方法，比如 equals 方法。</p></blockquote> <p>在 JDK 中内置了一些函数式接口供我们直接使用（列举部分），Lambda 表达式则可以灵活运用于函数式接口：</p> <ul><li><p>Predicate：定义了一个 <code>test()</code> 的抽象方法，接受泛型 T 对象，并返回一个 boolean。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> predicate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>predicate<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Consumer：定义了一个 <code>accept()</code> 的抽象方法，接受泛型 T 对象，没有返回（void）。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> consumer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Function：定义了一个 <code>apply()</code> 的抽象方法，接受泛型 T 对象，并返回一个泛型 R 的对象。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> function<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;is OK?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Supplier：定义了一个 <code>get()</code> 的抽象方法，没有传入参数，会返回一个泛型 T 的对象。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code>  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>supplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Runnable：定义了一个 <code>run()</code> 的抽象方法，没有传入参数也没有返回值，用于传入线程执行 <code>run()</code> 的具体实现方法。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="stream（流）"><a href="#stream（流）" class="header-anchor">#</a> Stream（流）</h2> <p>Stream 是 Java8 中非常重要的一个概念，因为在我们日常开发中，集合是使用非常频繁的，但是往往集合的遍历、过滤、排序操作并不是那么的简单，写完可能就是大段的代码。但是 Straam 的出现大大的简化了我们的写法，让代码的可读性提高了很多，先简单看一个流操作：</p> <p>需求：取出集合中的偶数并倒序排列</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 普通写法</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    result<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 流写法</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对比上面的普通写法，使用流的链式写法直接一行搞定。</p> <h3 id="流的操作"><a href="#流的操作" class="header-anchor">#</a> 流的操作</h3> <p>流的操作可以拆分为3个部分：获取流 -&gt; 中间操作 -&gt; 终端操作。</p> <p>上面的流操作：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取流</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 中间操作</span>
    <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 中间操作</span>
    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 终端操作</span>
</code></pre></div><p>中间操作是指操作完成以后返回的还是 Stream 流对象，还能继续处理的方法，终端操作是指操作完成以后无返回值或者返回值不为 Stream 的方法。</p> <p><strong>中间操作</strong>：</p> <table><thead><tr><th>操作</th> <th>返回类型</th> <th>操作参数</th> <th>描述</th></tr></thead> <tbody><tr><td>filter</td> <td>Stream</td> <td>Predicate</td> <td>过滤操作，过滤掉返回值为 false 的值</td></tr> <tr><td>map</td> <td>Stream</td> <td>Funcation&lt;T, R&gt;</td> <td>映射操作，将每项值映射返回为另一个值</td></tr> <tr><td>sorted</td> <td>Stream</td> <td>Comparator</td> <td>排序操作</td></tr> <tr><td>distinct</td> <td>Stream</td> <td></td> <td>去重操作</td></tr> <tr><td>skip</td> <td>Stream</td> <td>long</td> <td>跳过指定条数的值</td></tr> <tr><td>limit</td> <td>Stream</td> <td>long</td> <td>保留指定数据操作，保留前 n 条数据</td></tr> <tr><td>flatMap</td> <td>Stream</td> <td>Funcation&lt;T, Stream&gt;</td> <td>传入对象，转化为流，常用来降低集合或数组嵌套层级</td></tr></tbody></table> <p><strong>终端操作</strong>：</p> <table><thead><tr><th>操作</th> <th>返回类型</th> <th>操作参数</th> <th>描述</th></tr></thead> <tbody><tr><td>forEach</td> <td>void</td> <td>Consumer</td> <td>循环操作流</td></tr> <tr><td>count</td> <td>long</td> <td></td> <td>计数</td></tr> <tr><td>collect</td> <td>R</td> <td>Collector&lt;T, A, R&gt;</td> <td>收集器，收集流结果为集合</td></tr> <tr><td>anyMatch</td> <td>boolean</td> <td>Predicate</td> <td>判断是否有任意符合条件的元素返回 true，反之 false</td></tr> <tr><td>noneMatch</td> <td>boolean</td> <td>Predicate</td> <td>判断所有的元素都不符合条件返回 true，反之 false</td></tr> <tr><td>allMatch</td> <td>boolean</td> <td>Predicate</td> <td>判断所有的元素都符合条件返回 true，反之 false</td></tr> <tr><td>findAny</td> <td>Optional</td> <td></td> <td>返回任意一个元素，串行一般返回第一个，并行则不定</td></tr> <tr><td>findFirst</td> <td>Optional</td> <td></td> <td>返回第一个元素</td></tr> <tr><td>reduce</td> <td>Optional</td> <td>BinaryOperator</td> <td>合并操作，将元素两两进行计算并获取一个返回值，如此累加计算直至最后一项</td></tr></tbody></table> <h3 id="操作详细介绍"><a href="#操作详细介绍" class="header-anchor">#</a> 操作详细介绍</h3> <h4 id="获取流"><a href="#获取流" class="header-anchor">#</a> 获取流</h4> <p>常用的流的创建方式有以下几种：</p> <ul><li><p>Collection.stream：集合接口的默认方法。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>Stream.of()</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>Arrays.stream()</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">IntStream</span> stream <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h4 id="中间操作"><a href="#中间操作" class="header-anchor">#</a> 中间操作</h4> <p><strong>流的起始集合</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>filter</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 过滤奇数，获取偶数，保留filter方法中返回true的元素</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>map</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 将所有的值都乘以2，map即对每个元素做一定的处理，并返回新的元素</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>sorted</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 倒序排列</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>distinct</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 去重操作</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>skip</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 跳过（舍弃）前5条数据</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>limit</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 只保留前5条数据，舍弃后4条</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>flatMap</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// flatMap稍微复杂点，单独展示个例子</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token operator">::</span><span class="token function">stream</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 执行结果</span>
<span class="token comment">// [1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><h4 id="终端操作"><a href="#终端操作" class="header-anchor">#</a> 终端操作</h4> <p><strong>流的起始集合</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>forEach</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 使用forEach循环打印元素</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>count</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 计数</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>anyMatch</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 判断是否有任意一个大于0的元素</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>noneMatch</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 判断是否没有一个大于0的元素</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>allMatch</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 判断是否所有元素都大于0</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>findAny</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 任意获取一个元素</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>findFirst</strong>：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 任意获取一个元素</span>
list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>此处 <code>findAny()</code> 与 <code>findFirst()</code> 需要注意一个点是如果使用 <code>get()</code> 获取元素，当流为空的时候，会抛出 <code>java.util.NoSuchElementException</code> 异常，但是使用 <code>list.stream().findFirst().orElse(null);</code> 的话，没有元素则会返回 null 值，也可返回你需要的指定值。</p></blockquote> <p><strong>reduce</strong>：</p> <p>reduce 较为复杂点，共有三个重载方法：</p> <ul><li><p><code>T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);</code></p> <p>该方法传入两个参数，参数 <code>identity</code> 表示传入的起始值，参数 <code>accumulator</code> 是计算方法，使用两个元素进行计算，初始使用起始值与第一个值计算，然后使用计算结果代替起始值，继续与下一个值计算，最终得到一个结果。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 使用reduce累加计算，起始0</span>
<span class="token class-name">Integer</span> i <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果</span>
<span class="token comment">// 45</span>
</code></pre></div></li> <li><p><code>Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);</code></p> <p>该方法与上一方法的区别在于不需要传入起始值，直接使用第一个元素作为起始值计算，而且返回结果为 <code>Optional&lt;T&gt;</code>，与 <code>findAny</code> 方法返回值一致，可以使用 <code>get()</code> 与 <code>orElse(T other)</code> 方法来获取值。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 使用reduce累加计算，无起始值</span>
<span class="token class-name">Integer</span> i <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果</span>
<span class="token comment">// 45</span>
</code></pre></div></li> <li><p><code>&lt;U&gt; U reduce(U identity, BiFunction&lt;U, ? super T, U&gt; accumulator, BinaryOperator&lt;U&gt; combiner);</code></p> <p>该方法前两个参数类似第一个重载，分别是起始值和累加器，但是这个方法额外多了第三个参数，第三个参数的作用是当你使用 <code>parallelStream()</code> 并发执行 reduce 的时候，第三个参数即是用来将两个不同线程累加的结果合并的。</p> <p>除了参数的区别以外，这个方法最大的区别在于<strong>返回值不需要与传入累加器的值得类型一致</strong>，即可以传入一个 Integer 类型的数组，然后我返回一个 String 值，这在前两个方法是不被允许的。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 异步计算reduce方法，计算方法为字符串拼接</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果</span>
<span class="token comment">// &quot;123456789&quot;</span>
</code></pre></div></li></ul> <p><strong>collect（收集器）</strong>：</p> <p>收集器是用来将前面的处理结果收集处理为集合的，共有两个重载方法：</p> <ul><li><p><code>&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);</code></p> <p>这个为最常用的收集器方法，可以传入一个 <code>Collector</code>，一般即是直接调用 <code>Collectors</code> 类中的静态方法。</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 将结果转化为list</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 计数</span>
<span class="token class-name">Long</span> count <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">counting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token comment">// 求和</span>
<span class="token class-name">Integer</span> sum <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">summingInt</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>Collectors</code> 下面还有很多的方法都可以使用，具体情况可以依据自己需求使用。</p></li> <li><p><code>&lt;R&gt; R collect(Supplier&lt;R&gt; supplier, BiConsumer&lt;R, ? super T&gt; accumulator, BiConsumer&lt;R, R&gt; combiner);</code></p> <p>该方法与 <code>reduce</code> 方法有些类似，使用不多。</p></li></ul> <h2 id="optional"><a href="#optional" class="header-anchor">#</a> Optional</h2> <p>Optional 类是一个可以为null的容器对象。使用好 Optional 可以很好的解决空指针异常的问题，避免书写大量的 <code>if else</code> 判空操作。在上面介绍的流中，<code>findAny()</code> 与 <code>reduce()</code> 方法返回的就是 Optional 对象。</p> <h3 id="创建-optional"><a href="#创建-optional" class="header-anchor">#</a> 创建 Optional</h3> <p>创建 Optional 对象的方式有三种：</p> <ul><li><p><code>Optional.empty()</code></p> <p>创建一个空的 Optional 对象，内部未保存对象。</p></li> <li><p><code>Optional.of(T value)</code></p> <p>依据一个指定的对象来创建 Optional，此方法不接受空值，若传入空值将直接抛出 <code>NullPointException</code> 异常。</p></li> <li><p><code>Optional.ofNullable(T value)</code></p> <p>依据一个指定的对象来创建 Optional，此方法接受空值，传入空值将直接返回一个空的 Optional 对象，即与 <code>Optional.empty()</code> 一致。</p></li></ul> <h3 id="处理-optional"><a href="#处理-optional" class="header-anchor">#</a> 处理 Optional</h3> <p>Optional 中有一些处理的方法，类似于流中的处理方法：</p> <ul><li><p><code>Optional&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate)</code></p> <p>如果 Optional 非空并且满足条件则返回当前 Optional 中的对象，否则返回一个空的 Optional 对象。</p></li> <li><p><code>void ifPresent(Consumer&lt;? super T&gt; action)</code></p> <p>如果 Optional 非空则执行传入的方法。</p></li> <li><p><code>boolean isPresent()</code></p> <p>判断当前 Optional 是否为空，为空返回 false，不为空返回 true。</p></li> <li><p><code>boolean isEmpty()</code></p> <p>与 <code>isPresent()</code> 相反，为空返回 true，不为空返回 false。</p></li> <li><p><code>&lt;U&gt; Optional&lt;U&gt; map(Function&lt;? super T, ? extends U&gt; mapper)</code></p> <p>如果 Optional 非空则执行传入的函数调用并返回一个 Optional 值。</p></li> <li><p><code>&lt;U&gt; Optional&lt;U&gt; flatMap(Function&lt;? super T, ? extends Optional&lt;? extends U&gt;&gt; mapper)</code></p> <p>该方法与 <code>map()</code> 方法的区别在于传入的 <code>Function</code> 需要返回一个继承自 <code>Optional&lt;? extends U&gt;</code> 类型的返回值，当非空时则执行该 <code>Function</code> 并返回。</p></li></ul> <h3 id="获取-optional-值"><a href="#获取-optional-值" class="header-anchor">#</a> 获取 Optional 值</h3> <p>Optional 提供了一些方法来获取其中包含的对象值：</p> <ul><li><p><code>T get()</code></p> <p>返回包含的对象值，如果为空则抛出 <code>NullPointException</code> 异常。</p></li> <li><p><code>T orElse(T other)</code></p> <p>返回包含的对象值，如果为空则返回传入的指定值 other。</p></li> <li><p><code>T orElseGet(Supplier&lt;? extends T&gt; supplier)</code></p> <p>返回包含的对象值，如果为空则返回传入的 Supplier 接口生成的值。</p></li> <li><p><code>T orElseThrow()</code></p> <p>返回包含的对象值，如果为空则抛出 <code>NoSuchElementException</code> 异常。</p></li> <li><p><code>&lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X</code></p> <p>返回包含的对象值，如果为空则抛出传入的 Supplier 接口生成的异常对象。</p></li></ul> <h2 id="新日期时间"><a href="#新日期时间" class="header-anchor">#</a> 新日期时间</h2> <p>在 Java8 以前，JDK 提供了 Data 和 Calendar 用于处理时间，但是这两个处理时间都有很多的弊端，于是 Java8 吸取了 Joda-Time 库的经验，重新推出了一套时间处理 API，就是 <code>java.time</code> 包下的时间类，推荐使用新版本的时间类，下面来介绍下。（时间的概念可以参照廖雪峰老师写的<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1298613246361634" target="_blank" rel="noopener noreferrer">时间基本概念<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</p> <h3 id="常用时间类"><a href="#常用时间类" class="header-anchor">#</a> 常用时间类</h3> <p><code>java.time</code> 包下有以下常用的类。</p> <h4 id="本地日期与时间："><a href="#本地日期与时间：" class="header-anchor">#</a> 本地日期与时间：</h4> <ul><li>LocalDate：表示本地日期，只保存日期不保存时间。</li> <li>LocalTime：表示本地时间，只保存时间不保存日期。</li> <li>LocalDateTime：表示本地日期和时间，同时保存日期和时间。</li></ul> <p>本地时间类都实现了 Temporal 接口。</p> <p>常用通用方法：</p> <table><thead><tr><th>方法名</th> <th>是否静态方法</th> <th>描述</th></tr></thead> <tbody><tr><td>from</td> <td>是</td> <td>依据传入的 Temporal 对象创建对象实例</td></tr> <tr><td>now</td> <td>是</td> <td>依据系统时钟创建 Temporal 对象</td></tr> <tr><td>of</td> <td>是</td> <td>由 Temporal 对象的某个部分创建该对象的实例</td></tr> <tr><td>parse</td> <td>否</td> <td>由字符串创建 Temporal 对象的实例</td></tr> <tr><td>atOffset</td> <td>否</td> <td>将 Temporal 对象和某个时区偏移相结合</td></tr> <tr><td>atZone</td> <td>否</td> <td>将 Temporal 对象和某个时区相结合</td></tr> <tr><td>format</td> <td>否</td> <td>使用某个指定的格式器将 Temporal 对象转换为字符串（ Instant 类不提供该方法）</td></tr> <tr><td>get</td> <td>否</td> <td>读取 Temporal 对象的某一部分的值</td></tr> <tr><td>minus</td> <td>否</td> <td>创建 Temporal 对象的一个副本，通过将当前 Temporal 对象的值减去一定的时长创建该副本</td></tr> <tr><td>plus</td> <td>否</td> <td>创建 Temporal 对象的一个副本，通过将当前 Temporal 对象的值加上一定的时长创建该副本</td></tr> <tr><td>with</td> <td>否</td> <td>以该 Temporal 对象为模板，对某些状态进行修改创建该对象的副本</td></tr> <tr><td>isAfter</td> <td>否</td> <td>判断时间是否晚于传入的时间</td></tr> <tr><td>isBefore</td> <td>否</td> <td>判断时间是否早于传入的时间</td></tr></tbody></table> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取当前本地日期</span>
    <span class="token class-name">LocalDate</span> date <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;date ---&quot;</span> <span class="token operator">+</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取当前本地时间</span>
    <span class="token class-name">LocalTime</span> time <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;time ---&quot;</span> <span class="token operator">+</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 通过date和time生成本地日期与时间对象</span>
    <span class="token class-name">LocalDateTime</span> dateTime1 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime1 ---&quot;</span> <span class="token operator">+</span> dateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 通过dateTime1生成新的本地日期与时间对象</span>
    <span class="token class-name">LocalDateTime</span> dateTime2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime2 ---&quot;</span> <span class="token operator">+</span> dateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 减少一天</span>
    <span class="token class-name">LocalDateTime</span> dateTime3 <span class="token operator">=</span> dateTime2<span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime3 after minus ---&quot;</span> <span class="token operator">+</span> dateTime3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 增加两天</span>
    <span class="token class-name">LocalDateTime</span> dateTime4 <span class="token operator">=</span> dateTime3<span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime4 after plus ---&quot;</span> <span class="token operator">+</span> dateTime4<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 通过of创建 2020-07-31 10:10 的时间</span>
    <span class="token class-name">LocalDateTime</span> dateTime5 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime5 ---&quot;</span> <span class="token operator">+</span> dateTime5<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 减少一个月，因6月没有31号，自动调整为30号</span>
    <span class="token class-name">LocalDateTime</span> dateTime6 <span class="token operator">=</span> dateTime5<span class="token punctuation">.</span><span class="token function">minusMonths</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dateTime6 after plus ---&quot;</span> <span class="token operator">+</span> dateTime6<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果</span>
<span class="token comment">// date ---2020-08-20</span>
<span class="token comment">// time ---13:25:14.690414</span>
<span class="token comment">// dateTime1 ---2020-08-20T13:25:14.690414</span>
<span class="token comment">// dateTime2 ---2020-08-20T13:25:14.690414</span>
<span class="token comment">// dateTime3 after minus ---2020-08-19T13:25:14.690414</span>
<span class="token comment">// dateTime4 after plus ---2020-08-21T13:25:14.690414</span>
<span class="token comment">// dateTime5 ---2020-07-31T10:10</span>
<span class="token comment">// dateTime6 after plus ---2020-06-30T10:10</span>
</code></pre></div><blockquote><p>注意：本地时间类无法与时间戳互相转换，因为本地时间类不带有时区，无法准确转换成时间戳。</p></blockquote> <h4 id="带时区的日期和时间："><a href="#带时区的日期和时间：" class="header-anchor">#</a> 带时区的日期和时间：</h4> <ul><li>ZonedDateTime：表示带时区的日期和时间。可以简单理解为 <code>LocalDateTime</code> 与 <code>ZoneId</code> 结合，其他方法与 LocalDateTime 差不多。</li></ul> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认时区 Asia/Shanghai</span>
    <span class="token class-name">ZonedDateTime</span> zonedDateTime1 <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;zonedDateTime1 ---&quot;</span> <span class="token operator">+</span> zonedDateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 指定时区 America/New_York</span>
    <span class="token class-name">ZonedDateTime</span> zonedDateTime2 <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;America/New_York&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;zonedDateTime2 ---&quot;</span> <span class="token operator">+</span> zonedDateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果</span>
<span class="token comment">// zonedDateTime1 ---2020-08-20T14:14:12.202375+08:00[Asia/Shanghai]</span>
<span class="token comment">// zonedDateTime2 ---2020-08-20T02:14:12.204008-04:00[America/New_York]</span>
</code></pre></div><h4 id="时刻："><a href="#时刻：" class="header-anchor">#</a> 时刻：</h4> <ul><li>Instant：表示高精度时间戳，内部分别保存了以秒为单位的时间戳和更精确的纳秒精度</li></ul> <h4 id="时区："><a href="#时区：" class="header-anchor">#</a> 时区：</h4> <ul><li>ZoneId：表示时区。</li> <li>ZoneOffset：UTC 时间偏移量，用于表示与标准 UTC 时间偏移的时差。尽量使用 <code>ZoneId</code> 而不是 <code>ZoneOffset</code>，因为 <code>ZoneOffset</code> 会受到一些因素的影响导致并不是固定不变的，比如美国夏令时就会改变偏移量。</li></ul> <h4 id="时间间隔："><a href="#时间间隔：" class="header-anchor">#</a> 时间间隔：</h4> <ul><li>Duration：表示两个时刻之间的时间间隔。</li> <li>Period：表示两个日期之间的天数。</li></ul> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 计算两个时间之间差值</span>
    <span class="token class-name">LocalDateTime</span> start <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">LocalDateTime</span> end <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Duration</span> duration <span class="token operator">=</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;duration ---&quot;</span> <span class="token operator">+</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 计算两个本地时间之间的相差天数</span>
    <span class="token class-name">Period</span> period <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;period ---&quot;</span> <span class="token operator">+</span> period<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果(ISO 8601格式)</span>
<span class="token comment">// duration ---PT483H33M25.947865S  表示 483小时，33分钟，25.947865秒</span>
<span class="token comment">// period ---P2M11D  表示 2个月，11天</span>
</code></pre></div><h4 id="日期格式化："><a href="#日期格式化：" class="header-anchor">#</a> 日期格式化：</h4> <ul><li>DateTimeFormatter：时间格式化器，可以将非标准化字符串时间转化为时间对象或将时间对象转化为指定格式的字符串。</li></ul> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DateTimeFormatter</span> dtf <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy/MM/dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LocalDateTime</span> time <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;2020/08/20 15:16:17&quot;</span><span class="token punctuation">,</span> dtf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果</span>
<span class="token comment">// 2020/08/20 11:14:29</span>
<span class="token comment">// 2020-08-20T15:16:17</span>
</code></pre></div><h3 id="时间转换"><a href="#时间转换" class="header-anchor">#</a> 时间转换</h3> <ul><li><p>LocalDateTime &lt;-&gt; ZonedDateTime</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ZoneId</span> zoneId <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// LocalDateTime 转 ZonedDateTime</span>
    <span class="token class-name">ZonedDateTime</span> zonedDateTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span>zoneId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ZonedDateTime 转 LocalDateTime</span>
    <span class="token class-name">LocalDateTime</span> localDateTime <span class="token operator">=</span> zonedDateTime<span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>LocalDateTime &lt;-&gt; Instant</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ZoneId</span> zoneId <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ZoneOffset</span> offset <span class="token operator">=</span> <span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;+8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用 ZoneOffset 将 LocalDateTime 转 Instant</span>
    <span class="token comment">// 不推荐这种方式，因为偏移容易出现问题</span>
    <span class="token class-name">Instant</span> instant1 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用 ZoneId 将 LocalDateTime 转 Instant</span>
    <span class="token class-name">Instant</span> instant2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span>zoneId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 先将Instant 转 ZonedDateTime 然后转 LocalDateTime</span>
    <span class="token class-name">LocalDateTime</span> localDateTime1 <span class="token operator">=</span> instant1<span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span>zoneId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 直接使用 ofInstant 方法将 Instant 转 LocalDateTime</span>
    <span class="token class-name">LocalDateTime</span> localDateTime2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">ofInstant</span><span class="token punctuation">(</span>instant2<span class="token punctuation">,</span> zoneId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Date &lt;-&gt; LocalDateTime</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取系统默认时区</span>
    <span class="token class-name">ZoneId</span> zoneId <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// LocalDateTime 转 Date</span>
    <span class="token comment">// 先加上时区，转化为 ZonedDateTime</span>
    <span class="token class-name">ZonedDateTime</span> zonedDateTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span>zoneId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 转化为时间戳，然后转化为 Date</span>
    <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>zonedDateTime<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;date --- &quot;</span> <span class="token operator">+</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Date 转 LocalDateTime</span>
    <span class="token comment">// Date 转化成 Instant 时间戳</span>
    <span class="token class-name">Instant</span> instant <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 时间戳转化为本地时间</span>
    <span class="token class-name">LocalDateTime</span> localDateTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">ofInstant</span><span class="token punctuation">(</span>instant<span class="token punctuation">,</span> zoneId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;localDateTime --- &quot;</span> <span class="token operator">+</span> localDateTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果</span>
<span class="token comment">// date --- Thu Aug 20 14:42:42 CST 2020</span>
<span class="token comment">// localDateTime --- 2020-08-20T14:42:42.207</span>
</code></pre></div></li></ul> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ol><li><a href="https://juejin.im/post/6861849472499417096#heading-7" target="_blank" rel="noopener noreferrer">这篇最全 Java 8 讲解，有没有之一先看后说！<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255943660631584" target="_blank" rel="noopener noreferrer">日期与时间<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java-learning/internet/" class="prev">
        网络
      </a></span> <span class="next"><a href="/java-learning/other/distributed-lock.html">
        分布式锁
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/java-learning/assets/js/app.cce1b4e5.js" defer></script><script src="/java-learning/assets/js/2.073b9d23.js" defer></script><script src="/java-learning/assets/js/61.e51cee88.js" defer></script>
  </body>
</html>
